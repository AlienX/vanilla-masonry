/**
 * Vanilla Masonry v1.0 beta
 * A dynamic layout plugin. The flip-side of CSS Floats
 *
 * Licensed under the MIT license.
 * Copyright 2011 David DeSandro
 */
(function(a,b){function h(a,b){if(!!a){this.element=a,this.options=h.defaults;for(var c in b)this.options[c]=b[c];this._create(),this.build()}}function g(a,b,c){var d;return function(){function g(){c||a.apply(e,f),d=null}var e=this,f=arguments;d?clearTimeout(d):c&&a.apply(e,f),d=setTimeout(g,b||100)}}function f(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&(a.detachEvent("on"+b,a[b+c]),a[b+c]=null,a["e"+b+c]=null)}function e(b,c,d){b.addEventListener?b.addEventListener(c,d,!1):b.attachEvent&&(b["e"+c+d]=d,b[c+d]=function(){b["e"+c+d](a.event)},b.attachEvent("on"+c,b[c+d]))}function d(a,b,d){var e=b==="width",f=e?a.offsetWidth:a.offsetHeight,g=e?"Left":"Top",h=e?"Right":"Bottom",i=c(a),j=parseFloat(i["padding"+g])||0,k=parseFloat(i["padding"+h])||0,l=parseFloat(i["margin"+g])||0,m=parseFloat(i["margin"+h])||0,n=parseFloat(i["border"+g+"Width"])||0,o=parseFloat(i["border"+h+"Width"])||0;if(f>0)d?f+=l+m:f-=j+k+n+o;else{f=i[b];if(f<0||f==null)f=a.style[b]||0;f=parseFloat(f)||0,d&&(f+=j+k+l+m+n+o)}return f}"use strict";var c=document.defaultView&&document.defaultView.getComputedStyle?function(a){return document.defaultView.getComputedStyle(a,null)}:function(a){return a.currentStyle};a.getWH=d,a.addEvent=e,a.removeEvent=f,a.debounce=g;var i=["position","height"];h.defaults={isResizable:!0,gutterWidth:0,isRTL:!1,isFitWidth:!1},h.prototype={_getBricks:function(a){var b;for(var c=0,d=a.length;c<d;c++)b=a[c],b.style.position="absolute",b.className+=" masonry-brick",this.bricks.push(b)},_create:function(){this.reloadItems();var b=this.element.style;this._originalStyle={};for(var d=0,f=i.length;d<f;d++){var h=i[d];this._originalStyle[h]=b[h]||""}this.element.style.position="relative",this.horizontalDirection=this.options.isRTL?"right":"left",this.offset={};var j=c(this.element),k=this.options.isRTL?"paddingRight":"paddingLeft";this.offset.y=parseFloat(j.paddingTop)||0,this.offset.x=parseFloat(j[k])||0,this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth=="function";var l=this;setTimeout(function(){l.element.className+=" masonry"},0),this.options.isResizable&&e(a,"resize",g(function(){l.resize()}))},build:function(a){this._getColumns(),this._reLayout(a)},_getColumns:function(){var a=this.options.isFitWidth?this.element.parentNode:this.element,b=d(a,"width");this.columnWidth=this.isFluid?this.options.columnWidth(b):this.options.columnWidth||d(this.bricks[0],"width",!0)||b,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((b+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},reloadItems:function(){this.bricks=[],this._getBricks(this.element.children)},_reLayout:function(a){var b=this.cols;this.colYs=[];while(b--)this.colYs.push(0);this.layout(this.bricks,a)},layout:function(a,b){var c,e,f,g,h,i,j;for(var k=0,l=a.length;k<l;k++){c=a[k],e=Math.ceil(d(c,"width",!0)/this.columnWidth),e=Math.min(e,this.cols);if(e===1)j=this.colYs;else{f=this.cols+1-e,j=[];for(i=0;i<f;i++)h=this.colYs.slice(i,i+e),j[i]=Math.max.apply(Math,h)}this._placeBrick(c,j)}var m={};this.element.style.height=Math.max.apply(Math,this.colYs)+"px";if(this.options.isFitWidth){var n=0;k=this.cols;while(--k){if(this.colYs[k]!==0)break;n++}this.element.style.width=(this.cols-n)*this.columnWidth-this.options.gutterWidth+"px"}b&&b.call(a),this.isLaidOut=!0},_placeBrick:function(a,b){var c=Math.min.apply(Math,b),e=0;for(var f=0,g=b.length;f<g;f++)if(b[f]===c){e=f;break}a.style.top=c+this.offset.y+"px",a.style[this.horizontalDirection]=this.columnWidth*e+this.offset.x+"px";var h=c+d(a,"height",!0),i=this.cols+1-g;for(f=0;f<i;f++)this.colYs[e+f]=h},resize:function(){var a=this.cols;this._getColumns(),(this.isFluid||this.cols!==a)&&this._reLayout()}},a.Masonry=h})(window);
